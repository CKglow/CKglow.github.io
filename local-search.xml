<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Flutter链接MySQL</title>
    <link href="/2025/02/06/Flutter%E9%93%BE%E6%8E%A5MySQL/"/>
    <url>/2025/02/06/Flutter%E9%93%BE%E6%8E%A5MySQL/</url>
    
    <content type="html"><![CDATA[<h1 id="Flutter链接MySQL"><a href="#Flutter链接MySQL" class="headerlink" title="Flutter链接MySQL"></a>Flutter链接MySQL</h1><h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h1><p>Flutter官方对两种数据库更加推荐，且为它们提供了更好的支持，分别是<br>SQLite：一种本地数据库，优点顾名思义，更加轻量化，且对移动设备的支持更好；缺点是无法云上部署并通过IP链接<br>FireBase：由Google官方提供的NoSQL数据库，向用户提供了非常丰富的API接口，且为多用户聊天提供了很好的原生支持，是制作聊天功能的首选</p><p>这里仍然选择MySQL的原因：</p><ol><li>没学过数据库，用老牌数据库学一下常规操作先</li><li>可以云上部署，在自己的服务器上部署特别方便</li><li>在腾讯云服务器上部署规避Google科学上网的限制</li></ol><h1 id="2-MySQL-安装-简单配置"><a href="#2-MySQL-安装-简单配置" class="headerlink" title="2. MySQL 安装 简单配置"></a>2. MySQL 安装 简单配置</h1><h2 id="Ubuntu-服务器"><a href="#Ubuntu-服务器" class="headerlink" title="Ubuntu 服务器"></a>Ubuntu 服务器</h2><p>打开终端用ssh命令行安装还是太麻烦了<br>直接用宝塔的数据库功能，点添加数据库，填写config就好<br>更细致的操作，如创建用户、编辑权限、创建表等，点击phpMyAdmin进入php管理页面操作</p><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p>在MySQL官网下载安装包后安装</p><h2 id="SQL-可视化管理工具"><a href="#SQL-可视化管理工具" class="headerlink" title="SQL 可视化管理工具"></a>SQL 可视化管理工具</h2><p>推荐DBeaver，官网下载安装即可<br>配置简单，界面直观，功能丰富<br>可以管理云端数据库<br>支持多种SQL</p><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p>启动：<code>net start mysql</code>   尽量用管理员权限<br>关闭：<code>net stop mysql</code><br>本地链接    <code>mysql -u your_username -p</code>   root用户可能不用输入密码<br>列出所有数据库    <code>SHOW DATABASES;</code><br>选择要使用的数据库（进入数据库）    <code>USE your_database;</code><br>列出此数据库中的所有表    <code>SHOW TABLES;</code><br>创建数据库    <code>CREATE DATABASE 数据库名;</code><br>创建数据表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs MySQL">CREATE TABLE table_name (<br>    column1 datatype,<br>    column2 datatype,<br>    ...<br>);<br></code></pre></td></tr></table></figure><p>插入数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs MySQL">INSERT INTO table_name (column1, column2, column3, ...)<br>VALUES (value1, value2, value3, ...);<br></code></pre></td></tr></table></figure><h2 id="3-Flutter链接MySQL"><a href="#3-Flutter链接MySQL" class="headerlink" title="3. Flutter链接MySQL"></a>3. Flutter链接MySQL</h2><p>在pub.dev中，有三种第三方编写的MySQL插件，这里使用的是mysql_client<br><a href="https://pub.dev/packages/mysql_client">mysql_client | Dart package (pub.dev)</a><br>根据官方页面介绍，这个插件的功能有</p><ol><li>创建链接池</li><li>创建单链接</li><li>CRUD操作（插入、删除、查询、修改）<br>我们首先编写一个最最简单的Flutter界面，包含两个按钮：尝试链接、插入数据</li></ol><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs Dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() =&gt; runApp(MyApp());<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> MaterialApp(<br>      home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&#x27;MySQL Insert Example&#x27;</span>),<br>        ),<br>        body: Center(<br>          child: FutureBuilder&lt;<span class="hljs-keyword">void</span>&gt;(<br>            future: _insertData(),<br>            builder: (context, snapshot) &#123;<br>              <span class="hljs-keyword">if</span> (snapshot.connectionState == ConnectionState.done) &#123;<br>                <span class="hljs-keyword">if</span> (snapshot.hasError) &#123;<br>                  <span class="hljs-keyword">return</span> Text(<span class="hljs-string">&#x27;Error: <span class="hljs-subst">$&#123;snapshot.error&#125;</span>&#x27;</span>);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                  <span class="hljs-keyword">return</span> Column(<br>                    mainAxisAlignment: MainAxisAlignment.center,<br>                    children: &lt;Widget&gt;[<br>                      ElevatedButton(<br>                        onPressed: (),<br>                        child: Text(<span class="hljs-string">&#x27;Connect to MySQL&#x27;</span>),<br>                      ),<br>                      SizedBox(height: <span class="hljs-number">20</span>),<br>                      ElevatedButton(<br>                        onPressed: (),<br>                        child: Text(<span class="hljs-string">&#x27;Insert Data&#x27;</span>),<br>                      ),<br>                    ],<br>                  );<br>                &#125;<br>              &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> CircularProgressIndicator();<br>              &#125;<br>            &#125;,<br>          ),<br>        ),<br>      ),<br>    );<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>显而易见，后续的SQL操作需要编写独立的函数放在类里，并在<code>ElevatedButton</code>中的<code>onPressed()</code>里使用，这样点击按钮后执行我们编写的MySQL操作函数</p><p>安装包</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Dart">flutter pub add mysql_client<br></code></pre></td></tr></table></figure><p>引用包</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:mysql_client/mysql_client.dart&#x27;</span>;<br></code></pre></td></tr></table></figure><p>这里给出链接的函数</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs Dart">Future&lt;<span class="hljs-keyword">void</span>&gt; _insertData() <span class="hljs-keyword">async</span> &#123;    <span class="hljs-comment">//async是异步操作</span><br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Connecting to mysql server...&quot;</span>);<br>      <span class="hljs-comment">// create connection</span><br>      <span class="hljs-keyword">final</span> conn = <span class="hljs-keyword">await</span> MySQLConnection.createConnection(    <span class="hljs-comment">//链接MySQL服务器</span><br>        host: <span class="hljs-string">&quot;127.0.0.1&quot;</span>,                      <span class="hljs-comment">//这里链接云端服务器直接改IP就够了</span><br>        port: <span class="hljs-number">3306</span>,<br>        userName: <span class="hljs-string">&quot;root&quot;</span>,<br>        password: <span class="hljs-string">&quot;&quot;</span>,<br>        databaseName: <span class="hljs-string">&quot;test1&quot;</span>, <span class="hljs-comment">// optional</span><br>      );<br>      <br>      <span class="hljs-keyword">await</span> conn.connect();<br><br>      <span class="hljs-comment">// insert some rows</span><br>      <span class="hljs-keyword">var</span> res = <span class="hljs-keyword">await</span> conn.execute(<br>        <span class="hljs-string">&quot;INSERT INTO tabletest1 (name, email, age) VALUES (:name, :email, :age )&quot;</span>,<br>        &#123;                       <span class="hljs-comment">//上面这句其实就是MySQL命令行操作语句</span><br>          <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;aaaaa&quot;</span>,      <span class="hljs-comment">//这一部分根据表的格式和自己想插入的数据写</span><br>          <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;aaaaa.com&quot;</span>,<br>          <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">20</span>,<br>        &#125;,<br>      );<br><br>      <span class="hljs-built_in">print</span>(res.affectedRows);<br><br>      <span class="hljs-comment">// close all connections  操作结束后要关闭链接</span><br>      <span class="hljs-keyword">await</span> conn.close();<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br><br>      <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Error: <span class="hljs-subst">$e</span>&#x27;</span>);<br><br>    &#125;<br><br>  &#125;<br></code></pre></td></tr></table></figure><h1 id="4-完整程序"><a href="#4-完整程序" class="headerlink" title="4. 完整程序"></a>4. 完整程序</h1><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs Dart"><span class="hljs-comment">// main.dart</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:mysql_client/mysql_client.dart&#x27;</span>;<br><br><span class="hljs-keyword">void</span> main() =&gt; runApp(MyApp());<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>&#123;<br>  <span class="hljs-meta">@override</span><br>  Widget build(BuildContext context) &#123;<br>    <span class="hljs-keyword">return</span> MaterialApp(<br>      home: Scaffold(<br>        appBar: AppBar(<br>          title: Text(<span class="hljs-string">&#x27;MySQL Insert Example&#x27;</span>),<br>        ),<br>        body: Center(<br>          child: FutureBuilder&lt;<span class="hljs-keyword">void</span>&gt;(<br>            future: _insertData(),<br>            builder: (context, snapshot) &#123;<br>              <span class="hljs-keyword">if</span> (snapshot.connectionState == ConnectionState.done) &#123;<br>                <span class="hljs-keyword">if</span> (snapshot.hasError) &#123;<br>                  <span class="hljs-keyword">return</span> Text(<span class="hljs-string">&#x27;Error: <span class="hljs-subst">$&#123;snapshot.error&#125;</span>&#x27;</span>);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                  <span class="hljs-keyword">return</span> Column(<br>                    mainAxisAlignment: MainAxisAlignment.center,<br>                    children: &lt;Widget&gt;[<br>                      ElevatedButton(<br>                        onPressed: () =&gt; _showSnackbar(context, <span class="hljs-string">&#x27;Connected&#x27;</span>),<br>                        child: Text(<span class="hljs-string">&#x27;Connect to MySQL&#x27;</span>),<br>                      ),<br>                      SizedBox(height: <span class="hljs-number">20</span>),<br>                      ElevatedButton(<br>                        onPressed: () =&gt; _showSnackbar(context, <span class="hljs-string">&#x27;Inserted Data&#x27;</span>),<br>                        child: Text(<span class="hljs-string">&#x27;Insert Data&#x27;</span>),<br>                      ),<br>                    ],<br>                  );<br>                &#125;<br>              &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> CircularProgressIndicator();<br>              &#125;<br>            &#125;,<br>          ),<br>        ),<br>      ),<br>    );<br>  &#125;<br><br>  Future&lt;<span class="hljs-keyword">void</span>&gt; _insertData() <span class="hljs-keyword">async</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Connecting to mysql server...&quot;</span>);<br>      <span class="hljs-comment">// create connection</span><br>      <span class="hljs-keyword">final</span> conn = <span class="hljs-keyword">await</span> MySQLConnection.createConnection(<br>        host: <span class="hljs-string">&quot;127.0.0.1&quot;</span>,<br>        port: <span class="hljs-number">3306</span>,<br>        userName: <span class="hljs-string">&quot;root&quot;</span>,<br>        password: <span class="hljs-string">&quot;&quot;</span>,<br>        databaseName: <span class="hljs-string">&quot;test1&quot;</span>, <span class="hljs-comment">// optional</span><br>      );<br>      <span class="hljs-keyword">await</span> conn.connect();<br>      <span class="hljs-comment">// insert some rows</span><br>      <span class="hljs-keyword">var</span> res = <span class="hljs-keyword">await</span> conn.execute(<br>        <span class="hljs-string">&quot;INSERT INTO tabletest1 (name, email, age) VALUES (:name, :email, :age )&quot;</span>,<br>        &#123;<br>          <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;aaaaa&quot;</span>,<br>          <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;aaaaa.com&quot;</span>,<br>          <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">20</span>,<br>        &#125;,<br>      );<br>      <br>      <span class="hljs-built_in">print</span>(res.affectedRows);<br>      <br>      <span class="hljs-comment">// close all connections</span><br>      <span class="hljs-keyword">await</span> conn.close();<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>      <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Error: <span class="hljs-subst">$e</span>&#x27;</span>);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">void</span> _showSnackbar(BuildContext context, <span class="hljs-built_in">String</span> message) &#123;    <span class="hljs-comment">//APP底部的提示信息</span><br>    ScaffoldMessenger.of(context).showSnackBar(<br>      SnackBar(content: Text(message)),<br>    );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Code</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Code</tag>
      
      <tag>Web</tag>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>易拉宝展示</title>
    <link href="/2025/02/03/%E6%98%93%E6%8B%89%E5%AE%9D%E5%B1%95%E7%A4%BA/"/>
    <url>/2025/02/03/%E6%98%93%E6%8B%89%E5%AE%9D%E5%B1%95%E7%A4%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="易拉宝展示"><a href="#易拉宝展示" class="headerlink" title="易拉宝展示"></a>易拉宝展示</h1><p>以下是个人的易拉宝作品展示<br>（未展出易拉宝暂不上传）<br>随缘接单<br>欢迎扩列 QQ：1439429910<br><img src="https://alist.ckxtm.com/d/AliDrive/img/%E7%9F%A5%E7%A4%BC%E6%98%93%E6%8B%89%E5%AE%9D80180100.jpg" alt="知礼易拉宝241229"></p><p><img src="https://alist.ckxtm.com/d/AliDrive/img/0111%E7%9F%A5%E7%A4%BC%E6%98%93%E6%8B%89%E5%AE%9D2.3.jpg" alt="知礼易拉宝250111"></p><!-- ![鸭鸭易拉宝250209](https://alist.ckxtm.com/d/AliDrive/img/0209%E9%B8%AD%E9%B8%AD%E6%98%93%E6%8B%89%E5%AE%9D1.2.jpg) -->]]></content>
    
    
    <categories>
      
      <category>Idol</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ps</tag>
      
      <tag>Idol</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GPIO学习</title>
    <link href="/2025/02/03/GPIO%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/02/03/GPIO%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="GPIO-红外探测"><a href="#GPIO-红外探测" class="headerlink" title="GPIO | 红外探测"></a>GPIO | 红外探测</h1><h1 id="GPIO-红外探测-1"><a href="#GPIO-红外探测-1" class="headerlink" title="GPIO | 红外探测"></a>GPIO | 红外探测</h1><p>小车的循迹功能就是通过4路红外探测黑线来实现的</p><h2 id="GPIO-简介"><a href="#GPIO-简介" class="headerlink" title="GPIO 简介"></a>GPIO 简介</h2><p>GPIO就是从STM32芯片上引出的引脚，可以通过拉高&#x2F;拉低电平等方式简单粗暴地控制，也可以使用TIM、UART等系统资源控制，也可以检测GPIO端口电平的高低来实现数据输入。</p><h2 id="GPIO输出–以点亮LED为例"><a href="#GPIO输出–以点亮LED为例" class="headerlink" title="GPIO输出–以点亮LED为例"></a>GPIO输出–以点亮LED为例</h2><h3 id="编程顺序"><a href="#编程顺序" class="headerlink" title="编程顺序"></a>编程顺序</h3><ol><li>使能GPIO端口时钟</li><li>初始化GPIO引脚</li><li>控制GPIO输出高、低电平</li></ol><h3 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h3><h4 id="1-在-h文件中列出需要的GPIO的宏"><a href="#1-在-h文件中列出需要的GPIO的宏" class="headerlink" title="1.在.h文件中列出需要的GPIO的宏"></a>1.在.h文件中列出需要的GPIO的宏</h4><p>编程时使用宏定义便于提高程序的可移植性<br>每个.h文件都include这个头文件<br><code>#include &quot;stm32f10x.h&quot;</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/* 定义LED连接的GPIO端口, 用户只需要修改下面的代码即可改变控制的LED引脚 */</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_GPIO_PORT    GPIOC              <span class="hljs-comment">/* GPIO端口 */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_GPIO_CLK     RCC_APB2Periph_GPIOC<span class="hljs-comment">/* GPIO端口时钟 */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_GPIO_PINGPIO_Pin_2        <span class="hljs-comment">/*LED1在C2上*/</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_GPIO_PORT    GPIOC              <span class="hljs-comment">/* GPIO端口 */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_GPIO_CLK     RCC_APB2Periph_GPIOC<span class="hljs-comment">/* GPIO端口时钟 */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_GPIO_PINGPIO_Pin_3        <span class="hljs-comment">/*LED2在C3上*/</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/*两种控制GPIO电平的宏定义方法*/</span><br><br><span class="hljs-comment">/* 使用标准的固件库控制IO*/</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1(a)<span class="hljs-keyword">if</span> (a)\</span><br><span class="hljs-meta">GPIO_SetBits(LED1_GPIO_PORT,LED1_GPIO_PIN);\</span><br><span class="hljs-meta"><span class="hljs-keyword">else</span>\</span><br><span class="hljs-meta">GPIO_ResetBits(LED1_GPIO_PORT,LED1_GPIO_PIN)</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2(a)<span class="hljs-keyword">if</span> (a)\</span><br><span class="hljs-meta">GPIO_SetBits(LED2_GPIO_PORT,LED2_GPIO_PIN);\</span><br><span class="hljs-meta"><span class="hljs-keyword">else</span>\</span><br><span class="hljs-meta">GPIO_ResetBits(LED2_GPIO_PORT,LED2_GPIO_PIN)</span><br><span class="hljs-comment">//SetBits为高电平，ResetBits为低电平</span><br><br><br><br><span class="hljs-comment">/* 直接操作寄存器的方法控制IO */</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span>digitalHi(p,i) &#123;p-&gt;BSRR=i;&#125; <span class="hljs-comment">//输出为高电平</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> digitalLo(p,i) &#123;p-&gt;BRR=i;&#125; <span class="hljs-comment">//输出低电平</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> digitalToggle(p,i) &#123;p-&gt;ODR ^=i;&#125; <span class="hljs-comment">//输出反转状态</span></span><br><br><br><span class="hljs-comment">/* 定义控制IO的宏 */</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_TOGGLE digitalToggle(LED1_GPIO_PORT,LED1_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_HI   digitalHi(LED1_GPIO_PORT,LED1_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_LO   digitalLo(LED1_GPIO_PORT,LED1_GPIO_PIN)</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_TOGGLE digitalToggle(LED2_GPIO_PORT,LED2_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_HI   digitalHi(LED2_GPIO_PORT,LED2_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_LO   digitalLo(LED2_GPIO_PORT,LED2_GPIO_PIN)</span><br><span class="hljs-comment">//在实际使用中也可以根据开发板LED实际亮灭所需电平情况定义为LED1_ON.LED1_OFF</span><br></code></pre></td></tr></table></figure><h4 id="2-在-c文件中编写GPIO初始化函数"><a href="#2-在-c文件中编写GPIO初始化函数" class="headerlink" title="2.在.c文件中编写GPIO初始化函数"></a>2.在.c文件中编写GPIO初始化函数</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">LED_GPIO_Config</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br><span class="hljs-comment">/*定义一个GPIO_InitTypeDef类型的结构体*/</span><br>GPIO_InitTypeDef GPIO_InitStructure;<br><br><span class="hljs-comment">/*开启LED相关的GPIO外设时钟*/</span><br>RCC_APB2PeriphClockCmd( LED1_GPIO_CLK | LED2_GPIO_CLK , ENABLE);<br><span class="hljs-comment">/*选择要控制的GPIO引脚*/</span><br>GPIO_InitStructure.GPIO_Pin = LED1_GPIO_PIN;<br><br><span class="hljs-comment">/*设置引脚模式为通用推挽输出*/</span><br>GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;   <br><br><span class="hljs-comment">/*设置引脚速率为50MHz */</span>   <br>GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; <br><br><span class="hljs-comment">/*调用库函数，初始化GPIO*/</span><br>GPIO_Init(LED1_GPIO_PORT, &amp;GPIO_InitStructure);<br><br><span class="hljs-comment">/*选择要控制的GPIO引脚*/</span><br>GPIO_InitStructure.GPIO_Pin = LED2_GPIO_PIN;<br><br><span class="hljs-comment">/*调用库函数，初始化GPIO*/</span><br>GPIO_Init(LED2_GPIO_PORT, &amp;GPIO_InitStructure);<br><br><br><span class="hljs-comment">/* 关闭所有led灯*/</span><br>GPIO_SetBits(LED1_GPIO_PORT, LED1_GPIO_PIN);<br><br><span class="hljs-comment">/* 关闭所有led灯*/</span><br>GPIO_SetBits(LED2_GPIO_PORT, LED2_GPIO_PIN);<br>&#125;<br></code></pre></td></tr></table></figure><p>这个初始化函数是利用库文件写的，首先要打开GPIO端口的时钟，然后向GPIO_InitTypeDef结构体里填入想要配置的相关信息，最后用GPIO_Init()完成配置</p><h4 id="3-GPIO端口的8种工作模式"><a href="#3-GPIO端口的8种工作模式" class="headerlink" title="3.GPIO端口的8种工作模式"></a>3.GPIO端口的8种工作模式</h4><p>1、4种输入模式</p><p>（1）GPIO_Mode_IN_FLOATING 浮空输入<br>（2）GPIO_Mode_IPU 上拉输入<br>（3）GPIO_Mode_IPD 下拉输入<br>（4）GPIO_Mode_AIN 模拟输入</p><p>2、4种输出模式</p><p>（5）GPIO_Mode_Out_OD 开漏输出（带上拉或者下拉）<br>（6）GPIO_Mode_AF_OD 复用开漏输出（带上拉或者下拉）<br>（7）GPIO_Mode_Out_PP 推挽输出（带上拉或者下拉）<br>（8）GPIO_Mode_AF_PP 复用推挽输出（带上拉或者下拉）</p><p>最常用的就是前三种输入模式（根据外设实际情况而定），和复用推挽输出，速度多选50MHZ和10MHZ</p><h2 id="GPIO输入-以红外探测为例"><a href="#GPIO输入-以红外探测为例" class="headerlink" title="GPIO输入 以红外探测为例"></a>GPIO输入 以红外探测为例</h2><h3 id="红外探测器的使用方"><a href="#红外探测器的使用方" class="headerlink" title="红外探测器的使用方"></a>红外探测器的使用方</h3><p>小车的循迹功能就是通过4路红外探测黑线来实现的</p><h2 id="GPIO-简介-1"><a href="#GPIO-简介-1" class="headerlink" title="GPIO 简介"></a>GPIO 简介</h2><p>GPIO就是从STM32芯片上引出的引脚，可以通过拉高&#x2F;拉低电平等方式简单粗暴地控制，也可以使用TIM、UART等系统资源控制，也可以检测GPIO端口电平的高低来实现数据输入。</p><h2 id="GPIO输出–以点亮LED为例-1"><a href="#GPIO输出–以点亮LED为例-1" class="headerlink" title="GPIO输出–以点亮LED为例"></a>GPIO输出–以点亮LED为例</h2><h3 id="编程顺序-1"><a href="#编程顺序-1" class="headerlink" title="编程顺序"></a>编程顺序</h3><ol><li>使能GPIO端口时钟</li><li>初始化GPIO引脚</li><li>控制GPIO输出高、低电平</li></ol><h3 id="代码分析-1"><a href="#代码分析-1" class="headerlink" title="代码分析"></a>代码分析</h3><h4 id="1-在-h文件中列出需要的GPIO的宏-1"><a href="#1-在-h文件中列出需要的GPIO的宏-1" class="headerlink" title="1.在.h文件中列出需要的GPIO的宏"></a>1.在.h文件中列出需要的GPIO的宏</h4><p>编程时使用宏定义便于提高程序的可移植性<br>每个.h文件都include这个头文件<br><code>#include &quot;stm32f10x.h&quot;</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/* 定义LED连接的GPIO端口, 用户只需要修改下面的代码即可改变控制的LED引脚 */</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_GPIO_PORT    GPIOC              <span class="hljs-comment">/* GPIO端口 */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_GPIO_CLK     RCC_APB2Periph_GPIOC<span class="hljs-comment">/* GPIO端口时钟 */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_GPIO_PINGPIO_Pin_2        <span class="hljs-comment">/*LED1在C2上*/</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_GPIO_PORT    GPIOC              <span class="hljs-comment">/* GPIO端口 */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_GPIO_CLK     RCC_APB2Periph_GPIOC<span class="hljs-comment">/* GPIO端口时钟 */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_GPIO_PINGPIO_Pin_3        <span class="hljs-comment">/*LED2在C3上*/</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/*两种控制GPIO电平的宏定义方法*/</span><br><br><span class="hljs-comment">/* 使用标准的固件库控制IO*/</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1(a)<span class="hljs-keyword">if</span> (a)\</span><br><span class="hljs-meta">GPIO_SetBits(LED1_GPIO_PORT,LED1_GPIO_PIN);\</span><br><span class="hljs-meta"><span class="hljs-keyword">else</span>\</span><br><span class="hljs-meta">GPIO_ResetBits(LED1_GPIO_PORT,LED1_GPIO_PIN)</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2(a)<span class="hljs-keyword">if</span> (a)\</span><br><span class="hljs-meta">GPIO_SetBits(LED2_GPIO_PORT,LED2_GPIO_PIN);\</span><br><span class="hljs-meta"><span class="hljs-keyword">else</span>\</span><br><span class="hljs-meta">GPIO_ResetBits(LED2_GPIO_PORT,LED2_GPIO_PIN)</span><br><span class="hljs-comment">//SetBits为高电平，ResetBits为低电平</span><br><br><br><br><span class="hljs-comment">/* 直接操作寄存器的方法控制IO */</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span>digitalHi(p,i) &#123;p-&gt;BSRR=i;&#125; <span class="hljs-comment">//输出为高电平</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> digitalLo(p,i) &#123;p-&gt;BRR=i;&#125; <span class="hljs-comment">//输出低电平</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> digitalToggle(p,i) &#123;p-&gt;ODR ^=i;&#125; <span class="hljs-comment">//输出反转状态</span></span><br><br><br><span class="hljs-comment">/* 定义控制IO的宏 */</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_TOGGLE digitalToggle(LED1_GPIO_PORT,LED1_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_HI   digitalHi(LED1_GPIO_PORT,LED1_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED1_LO   digitalLo(LED1_GPIO_PORT,LED1_GPIO_PIN)</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_TOGGLE digitalToggle(LED2_GPIO_PORT,LED2_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_HI   digitalHi(LED2_GPIO_PORT,LED2_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LED2_LO   digitalLo(LED2_GPIO_PORT,LED2_GPIO_PIN)</span><br><span class="hljs-comment">//在实际使用中也可以根据开发板LED实际亮灭所需电平情况定义为LED1_ON.LED1_OFF</span><br></code></pre></td></tr></table></figure><h4 id="2-在-c文件中编写GPIO初始化函数-1"><a href="#2-在-c文件中编写GPIO初始化函数-1" class="headerlink" title="2.在.c文件中编写GPIO初始化函数"></a>2.在.c文件中编写GPIO初始化函数</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">LED_GPIO_Config</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br><span class="hljs-comment">/*定义一个GPIO_InitTypeDef类型的结构体*/</span><br>GPIO_InitTypeDef GPIO_InitStructure;<br><br><span class="hljs-comment">/*开启LED相关的GPIO外设时钟*/</span><br>RCC_APB2PeriphClockCmd( LED1_GPIO_CLK | LED2_GPIO_CLK , ENABLE);<br><span class="hljs-comment">/*选择要控制的GPIO引脚*/</span><br>GPIO_InitStructure.GPIO_Pin = LED1_GPIO_PIN;<br><br><span class="hljs-comment">/*设置引脚模式为通用推挽输出*/</span><br>GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;   <br><br><span class="hljs-comment">/*设置引脚速率为50MHz */</span>   <br>GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; <br><br><span class="hljs-comment">/*调用库函数，初始化GPIO*/</span><br>GPIO_Init(LED1_GPIO_PORT, &amp;GPIO_InitStructure);<br><br><span class="hljs-comment">/*选择要控制的GPIO引脚*/</span><br>GPIO_InitStructure.GPIO_Pin = LED2_GPIO_PIN;<br><br><span class="hljs-comment">/*调用库函数，初始化GPIO*/</span><br>GPIO_Init(LED2_GPIO_PORT, &amp;GPIO_InitStructure);<br><br><br><span class="hljs-comment">/* 关闭所有led灯*/</span><br>GPIO_SetBits(LED1_GPIO_PORT, LED1_GPIO_PIN);<br><br><span class="hljs-comment">/* 关闭所有led灯*/</span><br>GPIO_SetBits(LED2_GPIO_PORT, LED2_GPIO_PIN);<br>&#125;<br></code></pre></td></tr></table></figure><p>这个初始化函数是利用库文件写的，首先要打开GPIO端口的时钟，然后向GPIO_InitTypeDef结构体里填入想要配置的相关信息，最后用GPIO_Init()完成配置</p><h4 id="3-GPIO端口的8种工作模式-1"><a href="#3-GPIO端口的8种工作模式-1" class="headerlink" title="3.GPIO端口的8种工作模式"></a>3.GPIO端口的8种工作模式</h4><p>1、4种输入模式</p><p>（1）GPIO_Mode_IN_FLOATING 浮空输入<br>（2）GPIO_Mode_IPU 上拉输入<br>（3）GPIO_Mode_IPD 下拉输入<br>（4）GPIO_Mode_AIN 模拟输入</p><p>2、4种输出模式</p><p>（5）GPIO_Mode_Out_OD 开漏输出（带上拉或者下拉）<br>（6）GPIO_Mode_AF_OD 复用开漏输出（带上拉或者下拉）<br>（7）GPIO_Mode_Out_PP 推挽输出（带上拉或者下拉）<br>（8）GPIO_Mode_AF_PP 复用推挽输出（带上拉或者下拉）</p><p>最常用的就是前三种输入模式（根据外设实际情况而定），和复用推挽输出，速度多选50MHZ和10MHZ</p><h2 id="GPIO输入-以红外探测为例-1"><a href="#GPIO输入-以红外探测为例-1" class="headerlink" title="GPIO输入 以红外探测为例"></a>GPIO输入 以红外探测为例</h2><h3 id="红外传感器使用方法"><a href="#红外传感器使用方法" class="headerlink" title="红外传感器使用方法"></a>红外传感器使用方法</h3><p>通过查阅使用说明或者淘宝详情得知，当灵敏度调整正确时，在白色处输出低电平，LED亮；在黑色处输出高电平，LED灭。所以设计程序应该设置GPIO为上拉输入或浮空输入，即当探测到黑线时产生输入。这里我选择上拉输入，因为上拉输入更适合调整输入后产生的动作对应的延迟。</p><p>另外使用 GPIO_ReadInputDataBit(GPIOx_PORT,GPIOx_PIN) 来读取上拉输入。</p><p>XUNJI.h 里面的定义</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//IN 1 2 3 4 - A12 A2 A4 A5</span><br><span class="hljs-comment">//循迹5就是前面壁障的红外探头</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI1_GPIO_CLK     RCC_APB2Periph_GPIOA</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI1_GPIO_PORT    GPIOA</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI1_GPIO_PIN     GPIO_Pin_12</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI2_GPIO_CLK     RCC_APB2Periph_GPIOA</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI2_GPIO_PORT    GPIOA</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI2_GPIO_PIN     GPIO_Pin_2</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI3_GPIO_CLK     RCC_APB2Periph_GPIOA</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI3_GPIO_PORT    GPIOA</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI3_GPIO_PIN     GPIO_Pin_4</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI4_GPIO_CLK     RCC_APB2Periph_GPIOA</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI4_GPIO_PORT    GPIOA</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI4_GPIO_PIN     GPIO_Pin_5</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI5_GPIO_CLK     RCC_APB2Periph_GPIOC</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI5_GPIO_PORT    GPIOC</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> XUNJI5_GPIO_PIN     GPIO_Pin_0</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> R1 GPIO_ReadInputDataBit(XUNJI1_GPIO_PORT,XUNJI1_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> R2 GPIO_ReadInputDataBit(XUNJI2_GPIO_PORT,XUNJI2_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> L2 GPIO_ReadInputDataBit(XUNJI3_GPIO_PORT,XUNJI3_GPIO_PIN)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> L1 GPIO_ReadInputDataBit(XUNJI4_GPIO_PORT,XUNJI4_GPIO_PIN) <span class="hljs-comment">// L1 L2 R2 R1 </span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> F1 GPIO_ReadInputDataBit(XUNJI5_GPIO_PORT,XUNJI5_GPIO_PIN)</span><br></code></pre></td></tr></table></figure><p>配置XUNJI.c，初始化GPIO端口，写读取GPIO输入函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">xunji_Init</span><span class="hljs-params">()</span><br>&#123;<br>  GPIO_InitTypeDef GPIO_InitStructure;<br><br>  RCC_APB2PeriphClockCmd( XUNJI1_GPIO_CLK, ENABLE); <br>  GPIO_InitStructure.GPIO_Pin =  XUNJI1_GPIO_PIN|XUNJI2_GPIO_PIN|XUNJI3_GPIO_PIN|XUNJI4_GPIO_PIN;<br>  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;<span class="hljs-comment">//上拉输入</span><br>  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;<br>  GPIO_Init(XUNJI1_GPIO_PORT , &amp;GPIO_InitStructure); <br><br>RCC_APB2PeriphClockCmd( XUNJI5_GPIO_CLK, ENABLE); <br>  GPIO_InitStructure.GPIO_Pin =  XUNJI5_GPIO_PIN;<br>  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;<span class="hljs-comment">//上拉输入</span><br>  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;<br>  GPIO_Init(XUNJI5_GPIO_PORT , &amp;GPIO_InitStructure); <br><br><br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">Read_xunji_Date</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br> L1;<br>L2;<br>R2;<br>R1;<br>F1;<br>&#125;<br></code></pre></td></tr></table></figure><p>在 main.c 中，可以用循环和if语句来读取红外传感器的值并作出指令</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>)<br>&#123;<br>Read_xunji_Date();<br><span class="hljs-keyword">if</span>(L1==<span class="hljs-number">0</span>&amp;&amp;L2==<span class="hljs-number">1</span>&amp;&amp;R2==<span class="hljs-number">1</span>&amp;&amp;R1==<span class="hljs-number">0</span>)<span class="hljs-comment">//1为探测到黑线，0为白线</span><br>  &#123;<br>  Go();  <br>  delay_ms(<span class="hljs-number">100</span>);<br>  &#125; <br>&#125;<br></code></pre></td></tr></table></figure><p>具体的循迹指令可以参考源文件</p><p>但是主要是要理解循迹的逻辑，具体的代码还要根据实际跑道进行优化</p>]]></content>
    
    
    <categories>
      
      <category>Code</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Code</tag>
      
      <tag>Hardware</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MetroMap</title>
    <link href="/2025/02/03/MetroMap/"/>
    <url>/2025/02/03/MetroMap/</url>
    
    <content type="html"><![CDATA[<h1 id="怎样画一张地铁图-Ai"><a href="#怎样画一张地铁图-Ai" class="headerlink" title="怎样画一张地铁图 | Ai"></a>怎样画一张地铁图 | Ai</h1><p>1.使用钢笔工具，点击创建锚点后，按住 shift 移动光标（shift使光标只能水平、垂直、45°移动），继续创建锚点画出线路基本走向</p><p>2.调整描边颜色、端点和转角为圆滑</p><p>3.在 fx - 风格化 - 圆角 中选择线路转弯处圆角半径</p><p>4.使用椭圆工具，按住 shift 画出正圆，作为地铁站图标</p><p>5.搭配使用多边形工具、钢笔工具、曲率工具画出不规则图标</p><p>6.添加一点创意</p><p>7.导出时选择全画布导出</p><p>附上：城市天际线架空城市轨道交通图</p><p><img src="https://alist.ckxtm.com/d/AliDrive/img/%E6%B1%9F%E9%98%B3%E5%9C%B0%E9%93%813%E6%9C%9F%E7%BA%BF%E8%B7%AF%E5%9B%BE.png" alt="MetroMap"></p>]]></content>
    
    
    <categories>
      
      <category>Skill</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ai</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
